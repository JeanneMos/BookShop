"use strict";(self.webpackChunkespace_souvenir=self.webpackChunkespace_souvenir||[]).push([[58],{9716:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var a=n(5861),r=n(885),s=n(7757),i=n.n(s),l=n(7294),c=n(5998),u=n(6974),o=n(2849),p=n(7210),m=n(1935),d=n(7959),f=n(5320),b=n(324);function h(){var e=(0,c.v9)((function(e){return e.biography}));return l.createElement("div",{className:"biography-wrapper"},l.createElement("p",{className:"biography-body","data-testid":"biographyText"},(0,b.SQ)((0,b.iU)(null==e?void 0:e.biography))))}var E=n(2816),v=n(1295),g=l.lazy((function(){return n.e(307).then(n.bind(n,7620))}));function y(){var e=(0,c.v9)((function(e){return e.administrator})),t=(0,c.v9)((function(e){return e.biography})),n=(0,c.I0)(),s=(0,u.UO)(),b=(0,l.useState)(!1),y=(0,r.Z)(b,2),C=y[0],_=y[1],N=(0,l.useState)(!1),w=(0,r.Z)(N,2),Z=w[0],S=w[1],k=(0,l.useState)(null),x=(0,r.Z)(k,2),A=x[0],U=x[1],B=(0,f.Z)(),M=(0,l.useRef)(),R=(0,l.useRef)(),I=(0,l.useRef)(null),L=function(){_(!0)},j=function(){var e=(0,a.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={field_value:{field_bio_story:"",field_bio_photo:null},field_machine_name:o.r2,entity_hash:s.espaceId};try{B.mutate({data:t,apiUrl:o.R$},{onSuccess:function(e){var t,a=JSON.parse(null==e||null===(t=e.data)||void 0===t?void 0:t.field_value),r=a.field_bio_story,s=a.field_bio_custom;n((0,p.Hs)({biography:r,isBiographyEdited:s}))},onError:function(e){U("Une erreur s'est produite. Merci de réessayer plus tard"),(null==I?void 0:I.current)&&(0,d.Z)(I.current)}})}catch(e){U("Une erreur s'est produite. Merci de réessayer plus tard"),(null==I?void 0:I.current)&&(0,d.Z)(I.current)}case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return C?l.createElement(g,{closeForm:function(e){var t=e.messageSent;S(t),_(!1)},reference:M}):l.createElement(l.Fragment,null,Z&&l.createElement("p",{className:"message-status mb-40"},l.createElement(v.default,{name:"check",iconClass:"message-status-icon"}),l.createElement("span",null,"La biographie a bien été mise à jour.")),A&&l.createElement("p",{ref:I,className:"message-status mb-40"},l.createElement(v.default,{name:"cross",iconClass:"message-status-icon error-icon"}),l.createElement("span",null,A)),l.createElement("div",{className:"heading-button-wrapper between"},l.createElement("h2",{className:"content-heading-2",ref:R},"Biographie"),null!=t&&t.isBiographyEdited&&null!=t&&t.biography&&null!=e&&e.isAdmin?l.createElement(m.Z,{btnWrapperClass:"width-auto"},l.createElement(E.Z,{type:"button",btnClass:"bg-white",onClickAction:j},l.createElement(v.default,{name:"corbeille",iconClass:"current-icon"}),l.createElement("span",{className:"separator"}," "),l.createElement("span",{className:"button-text"},"Supprimer")),l.createElement(E.Z,{type:"button",btnClass:"bg-current",onClickAction:L},l.createElement(v.default,{name:"pencil",iconClass:"white-icon"}),l.createElement("span",{className:"separator"}," "),l.createElement("span",{className:"button-text"},"Modifier la biographie"))):null!=t&&t.isBiographyEdited||null==e||!e.isAdmin?null:l.createElement(E.Z,{type:"button",btnClass:"bg-current",onClickAction:L},l.createElement("span",{className:"button-text"},"Écrire la biographie"),l.createElement("span",{className:"separator"}," "),l.createElement(v.default,{name:"next",iconClass:"white-icon"}))),(null==t?void 0:t.biography)&&l.createElement(h,null))}},1935:function(e,t,n){n.d(t,{Z:function(){return i}});var a=n(4184),r=n.n(a),s=n(7294);function i(e){var t=e.position,n=e.children,a=e.btnWrapperClass;return s.createElement("div",{className:r()("buttons-wrapper",t,a)},n)}},5320:function(e,t,n){var a=n(9669),r=n.n(a),s=(n(7294),n(8767)),i={headers:{"Content-Type":"application/json"},withCredentials:!0,credentials:"include"};t.Z=function(e){var t=(0,s.useMutation)((function(t){var n=t.data,a=t.apiUrl,s=t.options,l=void 0===s?e||i:s;return r().post(a,n,l)})),n=t.data,a=t.error,l=(t.isError,t.isIdle,t.isLoading),c=(t.isPaused,t.isSuccess),u=t.mutate;t.mutateAsync,t.reset,t.status;return{mutate:u,isSuccess:c,data:n,isLoading:l,error:a}}}}]);